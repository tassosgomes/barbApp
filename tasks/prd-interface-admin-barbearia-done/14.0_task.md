---
status: pending
parallelizable: false
blocked_by: ["13.0"]
---

<task_context>
<domain>frontend/tests</domain>
<type>testing</type>
<scope>integration</scope>
<complexity>high</complexity>
<dependencies>playwright</dependencies>
<unblocks></unblocks>
</task_context>

# Tarefa 14.0: Implementar testes E2E e documentação final

## Visão Geral

Criar testes end-to-end com Playwright cobrindo fluxos completos de Admin Barbearia. Documentar todo o sistema, atualizar README e criar guias de uso.

<requirements>
- Testes E2E de fluxo completo
- Testes de casos de erro
- Documentação de API
- README atualizado
- Guias de uso para Admin Barbearia
- Ajustes finais de UX/UI
</requirements>

## Subtarefas

- [ ] 14.1 Criar testes E2E de login
- [ ] 14.2 Criar testes E2E de gestão de barbeiros
- [ ] 14.3 Criar testes E2E de gestão de serviços
- [ ] 14.4 Criar testes E2E de visualização de agendamentos
- [ ] 14.5 Criar testes de casos de erro (código inválido, credenciais erradas)
- [ ] 14.6 Criar testes de fluxo completo
- [ ] 14.7 Atualizar README com instruções de setup
- [ ] 14.8 Documentar variáveis de ambiente
- [ ] 14.9 Criar guia de uso para Admin Barbearia
- [ ] 14.10 Documentar diferenças entre Admin Central e Admin Barbearia
- [ ] 14.11 Realizar ajustes finais de UX/UI baseado em testes
- [ ] 14.12 Validar responsividade em dispositivos móveis

## Detalhes de Implementação

### Testes E2E - Fluxo Completo

```typescript
// tests/e2e/admin-barbearia/complete-flow.spec.ts
import { test, expect } from '@playwright/test';

test.describe('Admin Barbearia - Fluxo Completo', () => {
  const CODIGO = '6SJJRFPD';
  const EMAIL = 'tasso.gomes@outlook.com';
  const SENHA = 'senha123';

  test('should complete full workflow', async ({ page }) => {
    // 1. Login
    await page.goto(`/${CODIGO}/login`);
    await expect(page.locator('text=Barbearia do Tasso Zé')).toBeVisible();
    
    await page.fill('input[type="email"]', EMAIL);
    await page.fill('input[type="password"]', SENHA);
    await page.click('button:has-text("Entrar")');
    
    // 2. Verificar redirecionamento para dashboard
    await expect(page).toHaveURL(`/${CODIGO}/dashboard`);
    await expect(page.locator('h1')).toContainText('Bem-vindo');
    
    // 3. Navegar para Barbeiros
    await page.click('a:has-text("Barbeiros")');
    await expect(page).toHaveURL(`/${CODIGO}/barbeiros`);
    
    // 4. Criar novo barbeiro
    await page.click('button:has-text("Novo Barbeiro")');
    await page.fill('input[name="nome"]', 'João Silva');
    await page.fill('input[name="email"]', 'joao@example.com');
    await page.fill('input[name="telefone"]', '(11) 98765-4321');
    await page.click('button:has-text("Salvar")');
    
    // 5. Verificar toast de sucesso
    await expect(page.locator('text=Barbeiro criado com sucesso')).toBeVisible();
    
    // 6. Verificar barbeiro na listagem
    await expect(page.locator('text=João Silva')).toBeVisible();
    
    // 7. Navegar para Serviços
    await page.click('a:has-text("Serviços")');
    await expect(page).toHaveURL(`/${CODIGO}/servicos`);
    
    // 8. Criar novo serviço
    await page.click('button:has-text("Novo Serviço")');
    await page.fill('input[name="nome"]', 'Corte Moderno');
    await page.fill('input[name="duracaoMinutos"]', '30');
    await page.fill('input[name="preco"]', '50');
    await page.click('button:has-text("Salvar")');
    
    // 9. Verificar serviço na listagem
    await expect(page.locator('text=Corte Moderno')).toBeVisible();
    await expect(page.locator('text=R$ 50,00')).toBeVisible();
    
    // 10. Navegar para Agenda
    await page.click('a:has-text("Agenda")');
    await expect(page).toHaveURL(`/${CODIGO}/agenda`);
    
    // 11. Logout
    await page.click('button:has-text("Sair")');
    await expect(page).toHaveURL(`/${CODIGO}/login`);
  });
});
```

### Testes E2E - Casos de Erro

```typescript
// tests/e2e/admin-barbearia/error-cases.spec.ts
import { test, expect } from '@playwright/test';

test.describe('Admin Barbearia - Casos de Erro', () => {
  test('should show error for invalid codigo', async ({ page }) => {
    await page.goto('/INVALID!/login');
    await expect(page.locator('text=Barbearia não encontrada')).toBeVisible();
  });

  test('should show error for wrong credentials', async ({ page }) => {
    await page.goto('/6SJJRFPD/login');
    await page.fill('input[type="email"]', 'wrong@example.com');
    await page.fill('input[type="password"]', 'wrongpassword');
    await page.click('button:has-text("Entrar")');
    
    await expect(page.locator('text=Email ou senha incorretos')).toBeVisible();
  });

  test('should redirect to login if not authenticated', async ({ page }) => {
    await page.goto('/6SJJRFPD/dashboard');
    await expect(page).toHaveURL('/6SJJRFPD/login');
  });

  test('should validate form fields', async ({ page }) => {
    // Login first
    await page.goto('/6SJJRFPD/login');
    // ... login steps
    
    // Try to create barbeiro with invalid data
    await page.goto('/6SJJRFPD/barbeiros/novo');
    await page.click('button:has-text("Salvar")');
    
    await expect(page.locator('text=Nome é obrigatório')).toBeVisible();
    await expect(page.locator('text=Email é obrigatório')).toBeVisible();
  });
});
```

### Documentação - README Atualizado

```markdown
# BarbApp - Admin Barbearia

## Visão Geral

Interface administrativa para donos de barbearias gerenciarem seus negócios.

## Acesso

Cada barbearia tem uma URL única baseada em seu código:
```
https://app.barbapp.com/{CODIGO}/login
```

Exemplo: `https://app.barbapp.com/6SJJRFPD/login`

## Funcionalidades

- ✅ Login com email e senha
- ✅ Dashboard com métricas
- ✅ Gestão de barbeiros (criar, editar, desativar)
- ✅ Gestão de serviços (criar, editar, preços)
- ✅ Visualização de agendamentos

## Setup de Desenvolvimento

### Pré-requisitos
- Node.js 18+
- npm ou yarn

### Instalação

```bash
cd barbapp-admin
npm install
```

### Variáveis de Ambiente

```env
VITE_API_URL=http://localhost:5000
```

### Executar

```bash
npm run dev
```

### Testes

```bash
# Testes unitários
npm run test

# Testes E2E
npm run test:e2e
```

## Estrutura de Rotas

- `/:codigo/login` - Login
- `/:codigo/dashboard` - Dashboard
- `/:codigo/barbeiros` - Gestão de barbeiros
- `/:codigo/servicos` - Gestão de serviços
- `/:codigo/agenda` - Visualização de agendamentos

## Diferenças: Admin Central vs Admin Barbearia

| Funcionalidade | Admin Central | Admin Barbearia |
|----------------|---------------|-----------------|
| URL de acesso | `/admin/login` | `/{codigo}/login` |
| Gestão de barbearias | ✅ Todas | ❌ Nenhuma |
| Gestão de barbeiros | ❌ Nenhuma | ✅ Sua barbearia |
| Gestão de serviços | ❌ Nenhuma | ✅ Sua barbearia |
| Ver agendamentos | ❌ Nenhuma | ✅ Sua barbearia |

## Troubleshooting

### "Barbearia não encontrada"
- Verifique se o código está correto (8 caracteres)
- Verifique se a barbearia está ativa no sistema

### "Email ou senha incorretos"
- Confirme credenciais com Admin Central
- Solicite redefinição de senha se necessário
```

## Critérios de Sucesso

- [ ] Testes E2E cobrem fluxo completo de login → criar barbeiro → criar serviço → visualizar agenda → logout
- [ ] Testes cobrem casos de erro (código inválido, credenciais erradas, validação de formulário)
- [ ] README atualizado com instruções claras
- [ ] Variáveis de ambiente documentadas
- [ ] Guia de uso criado
- [ ] Diferenças entre Admin Central e Admin Barbearia documentadas
- [ ] Todos os testes E2E passam
- [ ] Responsividade validada em dispositivos móveis
- [ ] UX/UI refinada baseada em feedback de testes

## Arquivos Afetados

- `tests/e2e/admin-barbearia/complete-flow.spec.ts` (NOVO)
- `tests/e2e/admin-barbearia/error-cases.spec.ts` (NOVO)
- `tests/e2e/admin-barbearia/barbeiros.spec.ts` (NOVO)
- `tests/e2e/admin-barbearia/servicos.spec.ts` (NOVO)
- `tests/e2e/admin-barbearia/agenda.spec.ts` (NOVO)
- `README.md` (MODIFICADO)
- `docs/admin-barbearia-guide.md` (NOVO)
- `docs/environment-variables.md` (MODIFICADO)

## Estimativa

- **Esforço:** 3-4 dias
- **Complexidade:** Alta
