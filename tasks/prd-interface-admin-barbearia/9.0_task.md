---
status: completed
parallelizable: true
blocked_by: ["8.0"]
completed_date: 2025-10-18
---

<task_context>
<domain>frontend/services</domain>
<type>implementation</type>
<scope>core_feature</scope>
<complexity>low</complexity>
<dependencies>http_server</dependencies>
<unblocks>10.0</unblocks>
</task_context>

# Tarefa 9.0: Implementar serviços e tipos para gestão de barbeiros

## Visão Geral

Criar serviços, tipos TypeScript e schemas Zod para operações de gestão de barbeiros. Reutilizar endpoints backend existentes (`GET /api/barbeiros`, `POST /api/barbeiros`, etc.) garantindo isolamento por tenant via JWT.

<requirements>
- Tipos TypeScript para Barbeiro
- Schemas Zod para validação
- Serviço com métodos CRUD
- Paginação e filtros
- Tratamento de erros
- Cache com React Query
</requirements>

## Subtarefas

- [x] 9.1 Criar tipos em `src/types/barbeiro.ts` ✅
- [x] 9.2 Criar schemas Zod em `src/schemas/barbeiro.schema.ts` ✅
- [x] 9.3 Implementar `src/services/barbeiro.service.ts` ✅
- [x] 9.4 Adicionar métodos: list, getById, create, update, deactivate, reactivate ✅
- [x] 9.5 Implementar paginação e filtros ✅
- [x] 9.6 Criar testes unitários do serviço ✅

## Detalhes de Implementação

### Tipos

```typescript
// src/types/barbeiro.ts
export interface Barbeiro {
  id: string;
  nome: string;
  email: string;
  telefone: string;
  isActive: boolean;
  createdAt: string;
}

export interface CreateBarbeiroInput {
  nome: string;
  email: string;
  telefone: string;
}

export interface UpdateBarbeiroInput {
  nome?: string;
  email?: string;
  telefone?: string;
}

export interface ListBarbeirosParams {
  page?: number;
  pageSize?: number;
  search?: string;
  isActive?: boolean;
}

export interface PaginatedResponse<T> {
  items: T[];
  totalItems: number;
  page: number;
  pageSize: number;
  totalPages: number;
}
```

### Schema Zod

```typescript
// src/schemas/barbeiro.schema.ts
import { z } from 'zod';

export const createBarbeiroSchema = z.object({
  nome: z.string().min(3, 'Nome deve ter no mínimo 3 caracteres'),
  email: z.string().email('Email inválido'),
  telefone: z.string().regex(/^\(\d{2}\) \d{4,5}-\d{4}$/, 'Telefone inválido'),
});

export const updateBarbeiroSchema = z.object({
  nome: z.string().min(3).optional(),
  email: z.string().email().optional(),
  telefone: z.string().regex(/^\(\d{2}\) \d{4,5}-\d{4}$/).optional(),
});

export type CreateBarbeiroFormData = z.infer<typeof createBarbeiroSchema>;
export type UpdateBarbeiroFormData = z.infer<typeof updateBarbeiroSchema>;
```

### Serviço

```typescript
// src/services/barbeiro.service.ts
import { api } from './api';
import type {
  Barbeiro,
  CreateBarbeiroInput,
  UpdateBarbeiroInput,
  ListBarbeirosParams,
  PaginatedResponse,
} from '@/types/barbeiro';

export const barbeiroService = {
  list: async (params: ListBarbeirosParams = {}): Promise<PaginatedResponse<Barbeiro>> => {
    const response = await api.get<PaginatedResponse<Barbeiro>>('/api/barbeiros', { params });
    return response.data;
  },

  getById: async (id: string): Promise<Barbeiro> => {
    const response = await api.get<Barbeiro>(`/api/barbeiros/${id}`);
    return response.data;
  },

  create: async (data: CreateBarbeiroInput): Promise<Barbeiro> => {
    const response = await api.post<Barbeiro>('/api/barbeiros', data);
    return response.data;
  },

  update: async (id: string, data: UpdateBarbeiroInput): Promise<Barbeiro> => {
    const response = await api.put<Barbeiro>(`/api/barbeiros/${id}`, data);
    return response.data;
  },

  deactivate: async (id: string): Promise<void> => {
    await api.put(`/api/barbeiros/${id}/desativar`);
  },

  reactivate: async (id: string): Promise<void> => {
    await api.put(`/api/barbeiros/${id}/reativar`);
  },
};
```

## Critérios de Sucesso

- [x] Tipos TypeScript corretos e completos ✅
- [x] Schemas Zod validam corretamente ✅
- [x] Serviço implementa todos os métodos CRUD ✅
- [x] Paginação e filtros funcionam ✅
- [x] Tratamento de erros adequado ✅
- [x] Testes unitários com cobertura >= 80% ✅ (100% alcançado)

## Arquivos Afetados

- `src/types/barbeiro.ts` (NOVO)
- `src/schemas/barbeiro.schema.ts` (NOVO)
- `src/services/barbeiro.service.ts` (NOVO)
- `src/services/__tests__/barbeiro.service.test.ts` (NOVO)

## Estimativa

- **Esforço:** 1 dia
- **Complexidade:** Baixa
